case $- in
    *i*) ;;
      *) return;;
esac

source ~/.local/share/omarchy/default/bash/rc


# ============================================================================
# Path
# ============================================================================

# unset PATH
# PATH="/usr/local/bin:/usr/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin"
# export PATH

# {{ if stat (joinPath .homebrew.prefix "/bin/brew") -}}
# export PATH="{{ .homebrew.prefix }}/bin:{{ .homebrew.prefix }}/sbin:$PATH"
# {{ end -}}

# ============================================================================
# Options
# ============================================================================

export HISTFILE="$XDG_STATE_HOME/bash/history"
export HISTSIZE=100000
export HISTFILESIZE=100000
export SAVEHIST=100000

# Ensure history directory exists
mkdir -p "$(dirname "$HISTFILE")"

# Misc XDG-friendly configs for common tools (harmless if unused)
export LESSHISTFILE="$XDG_STATE_HOME/less/history"
export NPM_CONFIG_USERCONFIG="$XDG_CONFIG_HOME/npm/config"
export PIP_CONFIG_FILE="$XDG_CONFIG_HOME/pip/pip.conf"
export NODE_REPL_HISTORY="$XDG_STATE_HOME/node/repl_history"
export IPYTHONDIR="$XDG_CONFIG_HOME/ipython"
export CARGO_HOME="$XDG_DATA_HOME/cargo"
export RUSTUP_HOME="$XDG_DATA_HOME/rustup"
export GNUPGHOME="${GNUPGHOME:-$XDG_DATA_HOME/gnupg}"
export XCOMPOSEFILE="$XDG_CONFIG_HOME/X11/xcompose"
export CUDA_CACHE_PATH="$XDG_CACHE_HOME/nv"
export EDITOR="nvim"
export SSH_AUTH_SOCK=~/.1password/agent.sock

# ----------------------------------------------------------------------------
# History
# ----------------------------------------------------------------------------

shopt -s histappend              # append to history file, don't overwrite
shopt -s cmdhist                 # save multi-line commands as one command
HISTCONTROL=ignoreboth:erasedups # ignore duplicates and commands starting with space
PROMPT_COMMAND="history -a; history -c; history -r${PROMPT_COMMAND:+; $PROMPT_COMMAND}"

# ----------------------------------------------------------------------------
# Shell Options
# ----------------------------------------------------------------------------

shopt -s autocd                  # change to directory by typing its name
shopt -s cdspell                 # correct minor spelling errors in cd
shopt -s dirspell                # correct directory spelling during completion
shopt -s checkwinsize            # update LINES and COLUMNS after each command
shopt -s globstar                # ** matches recursively
shopt -s dotglob                 # * matches dotfiles
shopt -s extglob                 # extended pattern matching
shopt -s nocaseglob              # case-insensitive globbing

# ----------------------------------------------------------------------------
# Vi mode
# ----------------------------------------------------------------------------

set -o vi                        # vi-style line editing

# ----------------------------------------------------------------------------
# Completion
# ----------------------------------------------------------------------------

if [ -f /etc/bash_completion ]; then
    . /etc/bash_completion
fi

if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
fi

# ============================================================================
# Tools
# ============================================================================

{{ if lookPath "mise" -}}
eval "$(mise activate bash)"
{{- end }}

# ============================================================================
# Aliases
# ============================================================================

alias cz="chezmoi"
alias cdd="chezmoi cd"
alias gg="lazygit"
alias ll="eza -lha --group-directories-first --icons=auto"
